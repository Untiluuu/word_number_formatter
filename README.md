# Word文档数字格式化工具

## 功能说明

这是一个用于处理Word文档中数字格式的工具，可以将文档中的所有数字自动格式化为千分位格式，并保留其原始小数点。

### 现在会被排除的格式：

- 2025年11月25日 ✓ 不处理
- 2025-11-25 ✓ 不处理
- 2025/11/25 ✓ 不处理
- 47532.01% ✓ 不处理
- 25.5% ✓ 不处理
- 100% ✓ 不处理

### 格式化示例

- `10000` → `10,000`
- `10000.00` → `10,000.00`
- `1234567.89` → `1,234,567.89`
- `100` → `100`

## 使用方法

### 方式一：直接运行exe程序（推荐）

1. 双击运行 `Word数字格式化工具.exe`
2. 在图形界面中点击"选择文件"按钮，选择要处理的Word文档
3. 选择处理方式：
   - **覆盖原文件**：直接修改原文件
   - **另存为新文件**：保存为新文件，不修改原文件
4. 点击"开始处理"按钮
5. 等待处理完成，会显示处理结果

### 方式二：使用Python脚本

如果你的电脑上已安装Python，可以直接运行脚本：

1. 安装依赖：
```bash
pip install -r requirements.txt
```

2. 运行程序：
```bash
python word_number_formatter.py
```

## 打包为exe程序

### 手动打包

```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 打包
pyinstaller --onefile --windowed --name="Word数字格式化工具" word_number_formatter.py
```

## 技术特点

- ✅ 支持段落中的数字格式化
- ✅ 支持表格中的数字格式化
- ✅ 保持原有文字格式（字体、颜色、大小等）
- ✅ 友好的图形界面
- ✅ 支持进度提示
- ✅ 支持覆盖原文件或另存为新文件
- ✅ 自动识别所有数字（整数和小数）
- ✅ 千分位分隔符格式化
- ✅ 统一保留两位小数

## 注意事项

1. **文件格式**：仅支持 `.docx` 格式的Word文档（不支持 `.doc` 格式）
2. **备份建议**：处理重要文档前，建议先备份原文件
3. **数字识别**：工具会识别文档中所有的数字（包括文本和表格）
4. **格式保持**：处理后会保持原有的字体、颜色等格式

## 依赖项

- python-docx：用于处理Word文档
- tkinter：用于图形界面（Python自带）
- pyinstaller：用于打包exe程序

## 系统要求

- Windows 7 及以上版本
- 或者安装了Python 3.6+的任意系统

## 常见问题

**Q: 为什么有些数字没有被格式化？**
A: 工具使用正则表达式识别数字，如果数字和其他字符没有空格分隔，可能无法识别。

**Q: 可以自定义小数位数吗？**
A: 当前版本固定为2位小数，如需修改可编辑源代码中的 `format_number` 方法。

**Q: 支持批量处理多个文件吗？**
A: 当前版本仅支持单文件处理，如需批量处理功能可以扩展程序。

## 许可证

本工具仅供学习和内部使用。

## 更新日志

### v1.0.0 (2025-12-15)
- 初始版本发布
- 支持基本的数字格式化功能
- 提供图形界面
- 支持打包为exe程序
